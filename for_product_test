import urllib.request
from lxml import etree

new_url = 'http://biosfera.kz/product/product?path=13_451&product_id=5623'
#new_url = 'http://biosfera.kz/product/product?path=13_451&product_id=24005'
#new_url = 'http://biosfera.kz/product/product?path=13_451&product_id=13612'
new_request = urllib.request.Request(new_url)
new_response = urllib.request.urlopen(new_request)
new_html_code = new_response.read().decode('utf-8')
new_tree = etree.HTML(new_html_code)

#name
# (new_tree.xpath('.//span[@itemprop="name"]/text()'))
#price
#print(new_tree.xpath('.//div[@id="fix_price"]/text()'))



#print (new_tree.xpath('.//div[@class="lotDiscrTextInc"]/b/text()'))

#active_thug
##print (new_tree.xpath('.//div[@class="lotDiscrTextInc"]/p/text()'))

#print (new_tree.xpath('//*[text()="активные вещества:"]/../text()'))
#the best first 
#print (new_tree.xpath('//*[text()="активные вещества"]/..//text()'))
#Остаток
#print (new_tree.xpath('//*[preceding::i[.="активные вещества"]][following::i[.="вспомогательные вещества"]]/text()'))
#print ('ok')

name = (new_tree.xpath('.//span[@itemprop="name"]/text()')).__str__()
print ('name:' ,name.replace("['", "").replace("']", "") )

price = new_tree.xpath('.//div[@id="fix_price"]/text()').__str__()
print('price:' , price.replace("['", "").replace("']", ""))

main_active = (new_tree.xpath('//*[starts-with(text(),"активн")]/..//text()')).__str__()
print ('акт:',main_active.replace("\\xa0", "" ).replace("['", "").replace("']", ""))

other_active = (new_tree.xpath('//*[preceding::i[starts-with(.,"активн")]][following::i[starts-with(.,"вспомог")]]/text()')).__str__()
print ('Other:',other_active.replace("\\xa0", "" ).replace("['", "").replace("']", ""))


print ('ok')

http://sergo.eu/blog/online/python-3-sozdanie-xml
